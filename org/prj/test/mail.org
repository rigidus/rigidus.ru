

#+NAME:
#+BEGIN_SRC lisp
  (defun combine (x)
    (let ((prev)
          (result))
      (loop :for elt :across x :do
           (let ((old prev))
             (if (null prev)
                 (setf prev elt)
                 (progn
                   (setf prev elt)
                   (push (format nil "~A~A" old prev) result)))))
      (nreverse result)))

  (combine "1234567890")

  (let ((result))
    (loop :for idx :from 0 to 65535 :collect
         (let ((flag))
           (loop :for elt :in (combine (format nil "~4,'0B" idx)) :do
                (when (equal "11" elt)
                  (setf flag t)))
           (unless flag
             (push idx result))))
    (mapcar #'(lambda (x)
                (format t "~%~4,'0B" x))
            result))
#+END_SRC
